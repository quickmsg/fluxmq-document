(window.webpackJsonp=window.webpackJsonp||[]).push([[534],{980:function(t,_,v){"use strict";v.r(_);var r=v(25),s=Object(r.a)({},(function(){var t=this,_=t._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"离线存储功能"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#离线存储功能"}},[t._v("#")]),t._v(" 离线存储功能")]),t._v(" "),_("h2",{attrs:{id:"什么是离线消息"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#什么是离线消息"}},[t._v("#")]),t._v(" 什么是离线消息？")]),t._v(" "),_("ul",[_("li",[t._v("前提：离线消息必须是Qos=1或者Qos=2的消息")])]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[t._v("场景")])]),t._v(" "),_("th",[_("strong",[t._v("描述")])])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("当客户端发布的消息没有客户端订阅时，那么此消息被定义为离线消息")]),t._v(" "),_("td",[t._v("无订阅的消息")])]),t._v(" "),_("tr",[_("td",[t._v("ACK未确认的qos=1或者qos=2的消息，也会被定义为离线消息")]),t._v(" "),_("td",[t._v("ack未确认的消息")])])])]),t._v(" "),_("h2",{attrs:{id:"离线消息使用场景"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#离线消息使用场景"}},[t._v("#")]),t._v(" 离线消息使用场景")]),t._v(" "),_("p",[t._v("当设备没有确定投递到订阅的客户端，需要自动缓存消息，待设备上线后订阅消费消息，FluxMQ支持自动存储，订阅拉取消息，并完成消息投递，保证消息可达。")]),t._v(" "),_("h2",{attrs:{id:"离线消息存储方式"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#离线消息存储方式"}},[t._v("#")]),t._v(" 离线消息存储方式")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[t._v("方式")])]),t._v(" "),_("th",[_("strong",[t._v("描述")])])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("离线存储到Redis中")]),t._v(" "),_("td",[t._v("适用于消息量较大的场景")])]),t._v(" "),_("tr",[_("td",[t._v("离线存储到Mysql中")]),t._v(" "),_("td",[t._v("适用于小批量设备场景")])]),t._v(" "),_("tr",[_("td",[t._v("离线存储到Postgresql中")]),t._v(" "),_("td",[t._v("适用于小批量设备场景")])])])]),t._v(" "),_("h2",{attrs:{id:"离线消息结构"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#离线消息结构"}},[t._v("#")]),t._v(" 离线消息结构")]),t._v(" "),_("p",[t._v("下面为离线消息的报文格式，详细的报文也可以参考 "),_("RouterLink",{attrs:{to:"/2_0_16/views/gzyq/rule/EVENT.html"}},[t._v("数据类型")])],1),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[t._v("字段")])]),t._v(" "),_("th",[_("strong",[t._v("解释")])])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("id")]),t._v(" "),_("td",[t._v("消息唯一标识")])]),t._v(" "),_("tr",[_("td",[t._v("payload")]),t._v(" "),_("td",[t._v("MQTT 消息体")])]),t._v(" "),_("tr",[_("td",[t._v("messageId")]),t._v(" "),_("td",[t._v("MQTT 消息 ID")])]),t._v(" "),_("tr",[_("td",[t._v("topic")]),t._v(" "),_("td",[t._v("MQTT 主题")])]),t._v(" "),_("tr",[_("td",[t._v("qos")]),t._v(" "),_("td",[t._v("MQTT 消息的 QoS")])]),t._v(" "),_("tr",[_("td",[t._v("retain")]),t._v(" "),_("td",[t._v("MQTT 消息是否保持")])]),t._v(" "),_("tr",[_("td",[t._v("timestamp")]),t._v(" "),_("td",[t._v("事件触发时间 (单位：毫秒)")])]),t._v(" "),_("tr",[_("td",[t._v("clientId")]),t._v(" "),_("td",[t._v("客户端 ID")])]),t._v(" "),_("tr",[_("td",[t._v("clientIp")]),t._v(" "),_("td",[t._v("客户端的 IPAddress")])]),t._v(" "),_("tr",[_("td",[t._v("nodeIp")]),t._v(" "),_("td",[t._v("事件触发所在节点 IPAddress")])])])])])}),[],!1,null,null,null);_.default=s.exports}}]);