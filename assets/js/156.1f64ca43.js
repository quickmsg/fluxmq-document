(window.webpackJsonp=window.webpackJsonp||[]).push([[156],{284:function(t,a,s){t.exports=s.p+"assets/img/acl.6194bdbb.png"},558:function(t,a,s){t.exports=s.p+"assets/img/sql.81b39296.png"},940:function(t,a,s){"use strict";s.r(a);var _=s(25),v=Object(_.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"sql配置方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sql配置方式"}},[t._v("#")]),t._v(" SQL配置方式")]),t._v(" "),a("p",[a("img",{attrs:{src:s(558),alt:"img.png"}})]),t._v(" "),a("p",[t._v("通过SQL配置方式去加载ACL规则，当外部数据库ACL规则发生变化后，FluxMQ会定时去刷新ACL缓存，实现ACL缓存的热更新。")]),t._v(" "),a("h2",{attrs:{id:"acl拦截规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#acl拦截规则"}},[t._v("#")]),t._v(" ACL拦截规则")]),t._v(" "),a("p",[a("img",{attrs:{src:s(284),alt:"acl.png"}}),t._v("\n当客户端建立连接后，会加载ACL缓存(默认60S定时刷新),客户端发布订阅后，会根据其主题匹配是否存在"),a("code",[t._v("deny")]),t._v("规则，如果不存在"),a("code",[t._v("deny")]),t._v("规则，则ACl检查通过\n,如果存在Deny规则，再去检查是否存在"),a("code",[t._v("allow")]),t._v("规则,如果存在"),a("code",[t._v("allow")]),t._v("规则，acl检查通过，否则失败。")]),t._v(" "),a("h2",{attrs:{id:"配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[t._v("#")]),t._v(" 配置")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[t._v("配置项")])]),t._v(" "),a("th",[a("strong",[t._v("释义")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("驱动")]),t._v(" "),a("td",[t._v("选择对应数据库的jdbc驱动")])]),t._v(" "),a("tr",[a("td",[t._v("连接地址")]),t._v(" "),a("td",[t._v("数据库的连接地址")])]),t._v(" "),a("tr",[a("td",[t._v("用户名")]),t._v(" "),a("td",[t._v("数据库用户名")])]),t._v(" "),a("tr",[a("td",[t._v("密码")]),t._v(" "),a("td",[t._v("数据库密码")])]),t._v(" "),a("tr",[a("td",[t._v("加载sql")]),t._v(" "),a("td",[t._v("详情见如下"),a("code",[t._v("SQL配置")])])]),t._v(" "),a("tr",[a("td",[t._v("加载周期")]),t._v(" "),a("td",[t._v("定时去数据库刷新ACL缓存")])])])]),t._v(" "),a("h2",{attrs:{id:"sql配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sql配置"}},[t._v("#")]),t._v(" SQL配置")]),t._v(" "),a("blockquote",[a("p",[t._v("查询时必须返回 "),a("code",[t._v("subject")]),t._v(" ,"),a("code",[t._v("acl_type")]),t._v(","),a("code",[t._v("topic")]),t._v(","),a("code",[t._v("acl_strategy")]),t._v(","),a("code",[t._v("acl_action")]),t._v(" 字段\n如果数据库字段有区分，请使用别名。")])]),t._v(" "),a("p",[t._v("默认sql如下:")]),t._v(" "),a("div",{staticClass:"language-SQL extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" subject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("acl_type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("topic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("acl_strategy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("acl_action "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" acl\n")])])]),a("p",[t._v("具体字段配置请查看 "),a("a",{attrs:{href:"before"}},[t._v("ACL介绍")])])])}),[],!1,null,null,null);a.default=v.exports}}]);